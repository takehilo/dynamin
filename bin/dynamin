#!/usr/bin/env node

'use strict'

const dynamin = require('../lib')
const argv = require('minimist')(process.argv.slice(2))

if (!argv.r) {
  console.error('Error: region must be specified.')
  process.exit(1)
}
dynamin.AWS.config.update({region: argv.r})

if (!argv.t) {
  console.error('Error: table must be specified.')
  process.exit(1)
}
const tableName = argv.t

if (argv.p) {
  dynamin.AWS.config.credentials = new dynamin.AWS.SharedIniFileCredentials({profile: 'default'})
}

dynamin.update(tableName)
.then(() => {
  console.log(`Capacity units of ${tableName} and its indexes have successfully been minimized.`)
})
.catch((err) => {
  console.log(err.message)
})
